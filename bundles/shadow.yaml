# Shadow Environment Bundle
# Provides generic shadow environment capabilities for testing local git changes
name: shadow
version: "0.2.0"
description: |
  Shadow environments for safely testing local git changes in isolation.
  Snapshots your local working directories and serves them as git dependencies
  via URL rewriting, while other repos fetch from real GitHub.
  
  Works with ANY project (Python, Node, Rust, Go, etc.) - not tied to any specific ecosystem.

# No bundle-level tools - shadow tool only available to shadow agents via lazy activation
# This demonstrates tool separation: root sessions don't need shadow tool,
# only the shadow-operator agent does.

# Agents provided by this bundle
agents:
  shadow-operator:
    description: |
      Agent specialized in managing shadow environments for testing.
      Use this agent when you need to test local git changes in an isolated 
      container environment before pushing them.
      
      Supports ANY project type:
      - Python packages (uv, pip)
      - Node.js packages (npm, yarn)
      - Rust crates (cargo)
      - Go modules
      - Any git-based dependency
    instructions: shadow:agents/shadow-operator.md
    tools:
      - module: tool-shadow
        source: git+https://github.com/microsoft/amplifier-bundle-shadow@main#subdirectory=modules/tool-shadow

  shadow-smoke-test:
    description: |
      Independent validation agent for shadow environment smoke testing.
      Runs completely separate from the shadow-operator context to provide
      unbiased verification that local changes work correctly.
      
      Key capabilities:
      - Analyzes local changes to determine what SHOULD be tested
      - Verifies local sources are actually being used (not just configured)
      - Exercises touched code paths based on diff analysis
      - Proactively looks for issues the caller might have missed
      - Works with ANY project type (Python, Node, Rust, Go, etc.)
      
      Returns objective VERDICT: PASS/FAIL with evidence.
    instructions: shadow:agents/shadow-smoke-test.md
    tools:
      - module: tool-shadow
        source: git+https://github.com/microsoft/amplifier-bundle-shadow@main#subdirectory=modules/tool-shadow

# Context files
context:
  include:
    - shadow:context/shadow-instructions.md
